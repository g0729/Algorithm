WITH TEMP AS (
    SELECT
        *
    FROM
        REST_INFO
    WHERE
        ADDRESS LIKE "서울%"
)
# SELECT
#     *
# FROM
#     TEMP B
# LEFT JOIN
#     REST_REVIEW R
# ON
#     B.REST_ID = R.REST_ID
SELECT
    B.REST_ID,
    B.REST_NAME,
    B.FOOD_TYPE,
    B.FAVORITES,
    B.ADDRESS,
    ROUND(AVG(REVIEW_SCORE),2) AS SCORE
FROM
    TEMP B
JOIN 
    REST_REVIEW R
ON
    B.REST_ID = R.REST_ID
GROUP BY
    B.REST_ID
ORDER BY
    SCORE DESC,FAVORITES DESC
